{% extends 'base.html' %}
{% load static %}
{% block content %}

<div class="filters mb-3 d-flex align-items-center flex-wrap" style="gap: 1.5rem;">
  <!-- ðŸ”¹ Ð¡ÑÑ‹Ð»ÐºÐ¸ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð² -->
  <div class="d-flex align-items-center" style="gap: 1.5rem;">
    <a href="?filter=today" class="filter-link {% if active_filter == 'today' %}active{% endif %}">Today</a>
    <a href="?filter=week" class="filter-link {% if active_filter == 'week' %}active{% endif %}">Week</a>
    <a href="?filter=month" class="filter-link {% if active_filter == 'month' %}active{% endif %}">Month</a>
    <a href="?filter=period" class="filter-link {% if active_filter == 'period' %}active{% endif %}">Period</a>
  </div>

  <!-- ðŸ”¹ Ð¤Ð¾Ñ€Ð¼Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð° â€” Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð² Ñ‚Ð¾Ð¹ Ð¶Ðµ ÑÑ‚Ñ€Ð¾ÐºÐµ -->
  {% if active_filter == 'period' %}
  <form method="get" class="d-flex align-items-center ms-3" style="gap: 0.5rem;">
    <input type="hidden" name="filter" value="period">
    <label for="from_date" class="form-label fw-semibold mb-0 small text-muted">From:</label>
    <input type="date" id="from_date" name="from_date"
           value="{{ from_date|date:'Y-m-d' }}"
           class="form-control form-control-sm" style="width: auto;">

    <label for="to_date" class="form-label fw-semibold mb-0 small text-muted">To:</label>
    <input type="date" id="to_date" name="to_date"
           value="{{ to_date|date:'Y-m-d' }}"
           class="form-control form-control-sm" style="width: auto;">

    <button type="submit" class="btn btn-sm btn-success">Apply</button>
  </form>
  {% endif %}
</div>

  <!-- ðŸ”¹ Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¹ -->
  <table class="table table-hover align-middle">
    <thead>
      <tr>
        <th>Date</th>
        <th>Account</th>
        <th>Category</th>
        <th class="text-end">Amount</th>
      </tr>
    </thead>
    <tbody>
      {% for tx in transactions %}
      <tr onclick="window.location='{% if tx.category.type in 'Income,Outcome' %}{% url 'edit_transaction' tx.id %}{% elif tx.category.type == 'Transfer_from' %}{% url 'edit_transfer' tx.transfer_id %}{% endif %}'">
        <td>{{ tx.transaction_time|date:"Y-m-d H:i" }}</td>
        <td>{{ tx.account.name }}</td>
        <td>{{ tx.category.name }}</td>
        <td class="text-end {% if tx.category.type == 'Income' %}text-success{% elif tx.category.type == 'Outcome' %}text-danger{% endif %}">
          {% if tx.category.type == 'Income' %}+{% elif tx.category.type == 'Outcome' %}-{% endif %}
          {{ tx.amount }}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="4" class="text-center text-muted py-3">No transactions found</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
